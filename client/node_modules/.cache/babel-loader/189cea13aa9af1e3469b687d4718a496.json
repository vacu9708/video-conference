{"ast":null,"code":"/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimGetDisplayMedia = exports.shimGetUserMedia = undefined;\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n};\nvar _getusermedia = require('./getusermedia');\nObject.defineProperty(exports, 'shimGetUserMedia', {\n  enumerable: true,\n  get: function get() {\n    return _getusermedia.shimGetUserMedia;\n  }\n});\nvar _getdisplaymedia = require('./getdisplaymedia');\nObject.defineProperty(exports, 'shimGetDisplayMedia', {\n  enumerable: true,\n  get: function get() {\n    return _getdisplaymedia.shimGetDisplayMedia;\n  }\n});\nexports.shimOnTrack = shimOnTrack;\nexports.shimPeerConnection = shimPeerConnection;\nexports.shimSenderGetStats = shimSenderGetStats;\nexports.shimReceiverGetStats = shimReceiverGetStats;\nexports.shimRemoveStream = shimRemoveStream;\nexports.shimRTCDataChannel = shimRTCDataChannel;\nexports.shimAddTransceiver = shimAddTransceiver;\nexports.shimGetParameters = shimGetParameters;\nexports.shimCreateOffer = shimCreateOffer;\nexports.shimCreateAnswer = shimCreateAnswer;\nvar _utils = require('../utils');\nvar utils = _interopRequireWildcard(_utils);\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n      }\n    }\n    newObj.default = obj;\n    return newObj;\n  }\n}\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nfunction shimOnTrack(window) {\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCTrackEvent && 'receiver' in window.RTCTrackEvent.prototype && !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get: function get() {\n        return {\n          receiver: this.receiver\n        };\n      }\n    });\n  }\n}\nfunction shimPeerConnection(window, browserDetails) {\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || !(window.RTCPeerConnection || window.mozRTCPeerConnection)) {\n    return; // probably media.peerconnection.enabled=false in about:config\n  }\n\n  if (!window.RTCPeerConnection && window.mozRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.mozRTCPeerConnection;\n  }\n  if (browserDetails.version < 53) {\n    // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'].forEach(function (method) {\n      var nativeMethod = window.RTCPeerConnection.prototype[method];\n      var methodObj = _defineProperty({}, method, function () {\n        arguments[0] = new (method === 'addIceCandidate' ? window.RTCIceCandidate : window.RTCSessionDescription)(arguments[0]);\n        return nativeMethod.apply(this, arguments);\n      });\n      window.RTCPeerConnection.prototype[method] = methodObj[method];\n    });\n  }\n  var modernStatsTypes = {\n    inboundrtp: 'inbound-rtp',\n    outboundrtp: 'outbound-rtp',\n    candidatepair: 'candidate-pair',\n    localcandidate: 'local-candidate',\n    remotecandidate: 'remote-candidate'\n  };\n  var nativeGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    var _arguments = Array.prototype.slice.call(arguments),\n      selector = _arguments[0],\n      onSucc = _arguments[1],\n      onErr = _arguments[2];\n    return nativeGetStats.apply(this, [selector || null]).then(function (stats) {\n      if (browserDetails.version < 53 && !onSucc) {\n        // Shim only promise getStats with spec-hyphens in type names\n        // Leave callback version alone; misc old uses of forEach before Map\n        try {\n          stats.forEach(function (stat) {\n            stat.type = modernStatsTypes[stat.type] || stat.type;\n          });\n        } catch (e) {\n          if (e.name !== 'TypeError') {\n            throw e;\n          }\n          // Avoid TypeError: \"type\" is read-only, in old versions. 34-43ish\n          stats.forEach(function (stat, i) {\n            stats.set(i, Object.assign({}, stat, {\n              type: modernStatsTypes[stat.type] || stat.type\n            }));\n          });\n        }\n      }\n      return stats;\n    }).then(onSucc, onErr);\n  };\n}\nfunction shimSenderGetStats(window) {\n  if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpSender.prototype) {\n    return;\n  }\n  var origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n  if (origGetSenders) {\n    window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n      var _this = this;\n      var senders = origGetSenders.apply(this, []);\n      senders.forEach(function (sender) {\n        return sender._pc = _this;\n      });\n      return senders;\n    };\n  }\n  var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  if (origAddTrack) {\n    window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n      var sender = origAddTrack.apply(this, arguments);\n      sender._pc = this;\n      return sender;\n    };\n  }\n  window.RTCRtpSender.prototype.getStats = function getStats() {\n    return this.track ? this._pc.getStats(this.track) : Promise.resolve(new Map());\n  };\n}\nfunction shimReceiverGetStats(window) {\n  if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpReceiver.prototype) {\n    return;\n  }\n  var origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n  if (origGetReceivers) {\n    window.RTCPeerConnection.prototype.getReceivers = function getReceivers() {\n      var _this2 = this;\n      var receivers = origGetReceivers.apply(this, []);\n      receivers.forEach(function (receiver) {\n        return receiver._pc = _this2;\n      });\n      return receivers;\n    };\n  }\n  utils.wrapPeerConnectionEvent(window, 'track', function (e) {\n    e.receiver._pc = e.srcElement;\n    return e;\n  });\n  window.RTCRtpReceiver.prototype.getStats = function getStats() {\n    return this._pc.getStats(this.track);\n  };\n}\nfunction shimRemoveStream(window) {\n  if (!window.RTCPeerConnection || 'removeStream' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.removeStream = function removeStream(stream) {\n    var _this3 = this;\n    utils.deprecated('removeStream', 'removeTrack');\n    this.getSenders().forEach(function (sender) {\n      if (sender.track && stream.getTracks().includes(sender.track)) {\n        _this3.removeTrack(sender);\n      }\n    });\n  };\n}\nfunction shimRTCDataChannel(window) {\n  // rename DataChannel to RTCDataChannel (native fix in FF60):\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1173851\n  if (window.DataChannel && !window.RTCDataChannel) {\n    window.RTCDataChannel = window.DataChannel;\n  }\n}\nfunction shimAddTransceiver(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  var origAddTransceiver = window.RTCPeerConnection.prototype.addTransceiver;\n  if (origAddTransceiver) {\n    window.RTCPeerConnection.prototype.addTransceiver = function addTransceiver() {\n      this.setParametersPromises = [];\n      var initParameters = arguments[1];\n      var shouldPerformCheck = initParameters && 'sendEncodings' in initParameters;\n      if (shouldPerformCheck) {\n        // If sendEncodings params are provided, validate grammar\n        initParameters.sendEncodings.forEach(function (encodingParam) {\n          if ('rid' in encodingParam) {\n            var ridRegex = /^[a-z0-9]{0,16}$/i;\n            if (!ridRegex.test(encodingParam.rid)) {\n              throw new TypeError('Invalid RID value provided.');\n            }\n          }\n          if ('scaleResolutionDownBy' in encodingParam) {\n            if (!(parseFloat(encodingParam.scaleResolutionDownBy) >= 1.0)) {\n              throw new RangeError('scale_resolution_down_by must be >= 1.0');\n            }\n          }\n          if ('maxFramerate' in encodingParam) {\n            if (!(parseFloat(encodingParam.maxFramerate) >= 0)) {\n              throw new RangeError('max_framerate must be >= 0.0');\n            }\n          }\n        });\n      }\n      var transceiver = origAddTransceiver.apply(this, arguments);\n      if (shouldPerformCheck) {\n        // Check if the init options were applied. If not we do this in an\n        // asynchronous way and save the promise reference in a global object.\n        // This is an ugly hack, but at the same time is way more robust than\n        // checking the sender parameters before and after the createOffer\n        // Also note that after the createoffer we are not 100% sure that\n        // the params were asynchronously applied so we might miss the\n        // opportunity to recreate offer.\n        var sender = transceiver.sender;\n        var params = sender.getParameters();\n        if (!('encodings' in params) ||\n        // Avoid being fooled by patched getParameters() below.\n        params.encodings.length === 1 && Object.keys(params.encodings[0]).length === 0) {\n          params.encodings = initParameters.sendEncodings;\n          sender.sendEncodings = initParameters.sendEncodings;\n          this.setParametersPromises.push(sender.setParameters(params).then(function () {\n            delete sender.sendEncodings;\n          }).catch(function () {\n            delete sender.sendEncodings;\n          }));\n        }\n      }\n      return transceiver;\n    };\n  }\n}\nfunction shimGetParameters(window) {\n  if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCRtpSender)) {\n    return;\n  }\n  var origGetParameters = window.RTCRtpSender.prototype.getParameters;\n  if (origGetParameters) {\n    window.RTCRtpSender.prototype.getParameters = function getParameters() {\n      var params = origGetParameters.apply(this, arguments);\n      if (!('encodings' in params)) {\n        params.encodings = [].concat(this.sendEncodings || [{}]);\n      }\n      return params;\n    };\n  }\n}\nfunction shimCreateOffer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  var origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer = function createOffer() {\n    var _this4 = this,\n      _arguments2 = arguments;\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises).then(function () {\n        return origCreateOffer.apply(_this4, _arguments2);\n      }).finally(function () {\n        _this4.setParametersPromises = [];\n      });\n    }\n    return origCreateOffer.apply(this, arguments);\n  };\n}\nfunction shimCreateAnswer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  var origCreateAnswer = window.RTCPeerConnection.prototype.createAnswer;\n  window.RTCPeerConnection.prototype.createAnswer = function createAnswer() {\n    var _this5 = this,\n      _arguments3 = arguments;\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises).then(function () {\n        return origCreateAnswer.apply(_this5, _arguments3);\n      }).finally(function () {\n        _this5.setParametersPromises = [];\n      });\n    }\n    return origCreateAnswer.apply(this, arguments);\n  };\n}","map":{"version":3,"names":["Object","defineProperty","exports","value","shimGetDisplayMedia","shimGetUserMedia","undefined","_typeof","Symbol","iterator","obj","constructor","prototype","_getusermedia","require","enumerable","get","_getdisplaymedia","shimOnTrack","shimPeerConnection","shimSenderGetStats","shimReceiverGetStats","shimRemoveStream","shimRTCDataChannel","shimAddTransceiver","shimGetParameters","shimCreateOffer","shimCreateAnswer","_utils","utils","_interopRequireWildcard","__esModule","newObj","key","hasOwnProperty","call","default","_defineProperty","configurable","writable","window","RTCTrackEvent","receiver","browserDetails","RTCPeerConnection","mozRTCPeerConnection","version","forEach","method","nativeMethod","methodObj","arguments","RTCIceCandidate","RTCSessionDescription","apply","modernStatsTypes","inboundrtp","outboundrtp","candidatepair","localcandidate","remotecandidate","nativeGetStats","getStats","_arguments","Array","slice","selector","onSucc","onErr","then","stats","stat","type","e","name","i","set","assign","RTCRtpSender","origGetSenders","getSenders","_this","senders","sender","_pc","origAddTrack","addTrack","track","Promise","resolve","Map","RTCRtpReceiver","origGetReceivers","getReceivers","_this2","receivers","wrapPeerConnectionEvent","srcElement","removeStream","stream","_this3","deprecated","getTracks","includes","removeTrack","DataChannel","RTCDataChannel","origAddTransceiver","addTransceiver","setParametersPromises","initParameters","shouldPerformCheck","sendEncodings","encodingParam","ridRegex","test","rid","TypeError","parseFloat","scaleResolutionDownBy","RangeError","maxFramerate","transceiver","params","getParameters","encodings","length","keys","push","setParameters","catch","origGetParameters","concat","origCreateOffer","createOffer","_this4","_arguments2","all","finally","origCreateAnswer","createAnswer","_this5","_arguments3"],"sources":["G:/Software/github/video-conference/client/node_modules/webrtc-adapter/dist/firefox/firefox_shim.js"],"sourcesContent":["/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimGetDisplayMedia = exports.shimGetUserMedia = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _getusermedia = require('./getusermedia');\n\nObject.defineProperty(exports, 'shimGetUserMedia', {\n  enumerable: true,\n  get: function get() {\n    return _getusermedia.shimGetUserMedia;\n  }\n});\n\nvar _getdisplaymedia = require('./getdisplaymedia');\n\nObject.defineProperty(exports, 'shimGetDisplayMedia', {\n  enumerable: true,\n  get: function get() {\n    return _getdisplaymedia.shimGetDisplayMedia;\n  }\n});\nexports.shimOnTrack = shimOnTrack;\nexports.shimPeerConnection = shimPeerConnection;\nexports.shimSenderGetStats = shimSenderGetStats;\nexports.shimReceiverGetStats = shimReceiverGetStats;\nexports.shimRemoveStream = shimRemoveStream;\nexports.shimRTCDataChannel = shimRTCDataChannel;\nexports.shimAddTransceiver = shimAddTransceiver;\nexports.shimGetParameters = shimGetParameters;\nexports.shimCreateOffer = shimCreateOffer;\nexports.shimCreateAnswer = shimCreateAnswer;\n\nvar _utils = require('../utils');\n\nvar utils = _interopRequireWildcard(_utils);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction shimOnTrack(window) {\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCTrackEvent && 'receiver' in window.RTCTrackEvent.prototype && !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get: function get() {\n        return { receiver: this.receiver };\n      }\n    });\n  }\n}\n\nfunction shimPeerConnection(window, browserDetails) {\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || !(window.RTCPeerConnection || window.mozRTCPeerConnection)) {\n    return; // probably media.peerconnection.enabled=false in about:config\n  }\n  if (!window.RTCPeerConnection && window.mozRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.mozRTCPeerConnection;\n  }\n\n  if (browserDetails.version < 53) {\n    // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'].forEach(function (method) {\n      var nativeMethod = window.RTCPeerConnection.prototype[method];\n      var methodObj = _defineProperty({}, method, function () {\n        arguments[0] = new (method === 'addIceCandidate' ? window.RTCIceCandidate : window.RTCSessionDescription)(arguments[0]);\n        return nativeMethod.apply(this, arguments);\n      });\n      window.RTCPeerConnection.prototype[method] = methodObj[method];\n    });\n  }\n\n  var modernStatsTypes = {\n    inboundrtp: 'inbound-rtp',\n    outboundrtp: 'outbound-rtp',\n    candidatepair: 'candidate-pair',\n    localcandidate: 'local-candidate',\n    remotecandidate: 'remote-candidate'\n  };\n\n  var nativeGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    var _arguments = Array.prototype.slice.call(arguments),\n        selector = _arguments[0],\n        onSucc = _arguments[1],\n        onErr = _arguments[2];\n\n    return nativeGetStats.apply(this, [selector || null]).then(function (stats) {\n      if (browserDetails.version < 53 && !onSucc) {\n        // Shim only promise getStats with spec-hyphens in type names\n        // Leave callback version alone; misc old uses of forEach before Map\n        try {\n          stats.forEach(function (stat) {\n            stat.type = modernStatsTypes[stat.type] || stat.type;\n          });\n        } catch (e) {\n          if (e.name !== 'TypeError') {\n            throw e;\n          }\n          // Avoid TypeError: \"type\" is read-only, in old versions. 34-43ish\n          stats.forEach(function (stat, i) {\n            stats.set(i, Object.assign({}, stat, {\n              type: modernStatsTypes[stat.type] || stat.type\n            }));\n          });\n        }\n      }\n      return stats;\n    }).then(onSucc, onErr);\n  };\n}\n\nfunction shimSenderGetStats(window) {\n  if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpSender.prototype) {\n    return;\n  }\n  var origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n  if (origGetSenders) {\n    window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n      var _this = this;\n\n      var senders = origGetSenders.apply(this, []);\n      senders.forEach(function (sender) {\n        return sender._pc = _this;\n      });\n      return senders;\n    };\n  }\n\n  var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  if (origAddTrack) {\n    window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n      var sender = origAddTrack.apply(this, arguments);\n      sender._pc = this;\n      return sender;\n    };\n  }\n  window.RTCRtpSender.prototype.getStats = function getStats() {\n    return this.track ? this._pc.getStats(this.track) : Promise.resolve(new Map());\n  };\n}\n\nfunction shimReceiverGetStats(window) {\n  if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpReceiver.prototype) {\n    return;\n  }\n  var origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n  if (origGetReceivers) {\n    window.RTCPeerConnection.prototype.getReceivers = function getReceivers() {\n      var _this2 = this;\n\n      var receivers = origGetReceivers.apply(this, []);\n      receivers.forEach(function (receiver) {\n        return receiver._pc = _this2;\n      });\n      return receivers;\n    };\n  }\n  utils.wrapPeerConnectionEvent(window, 'track', function (e) {\n    e.receiver._pc = e.srcElement;\n    return e;\n  });\n  window.RTCRtpReceiver.prototype.getStats = function getStats() {\n    return this._pc.getStats(this.track);\n  };\n}\n\nfunction shimRemoveStream(window) {\n  if (!window.RTCPeerConnection || 'removeStream' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.removeStream = function removeStream(stream) {\n    var _this3 = this;\n\n    utils.deprecated('removeStream', 'removeTrack');\n    this.getSenders().forEach(function (sender) {\n      if (sender.track && stream.getTracks().includes(sender.track)) {\n        _this3.removeTrack(sender);\n      }\n    });\n  };\n}\n\nfunction shimRTCDataChannel(window) {\n  // rename DataChannel to RTCDataChannel (native fix in FF60):\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1173851\n  if (window.DataChannel && !window.RTCDataChannel) {\n    window.RTCDataChannel = window.DataChannel;\n  }\n}\n\nfunction shimAddTransceiver(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  var origAddTransceiver = window.RTCPeerConnection.prototype.addTransceiver;\n  if (origAddTransceiver) {\n    window.RTCPeerConnection.prototype.addTransceiver = function addTransceiver() {\n      this.setParametersPromises = [];\n      var initParameters = arguments[1];\n      var shouldPerformCheck = initParameters && 'sendEncodings' in initParameters;\n      if (shouldPerformCheck) {\n        // If sendEncodings params are provided, validate grammar\n        initParameters.sendEncodings.forEach(function (encodingParam) {\n          if ('rid' in encodingParam) {\n            var ridRegex = /^[a-z0-9]{0,16}$/i;\n            if (!ridRegex.test(encodingParam.rid)) {\n              throw new TypeError('Invalid RID value provided.');\n            }\n          }\n          if ('scaleResolutionDownBy' in encodingParam) {\n            if (!(parseFloat(encodingParam.scaleResolutionDownBy) >= 1.0)) {\n              throw new RangeError('scale_resolution_down_by must be >= 1.0');\n            }\n          }\n          if ('maxFramerate' in encodingParam) {\n            if (!(parseFloat(encodingParam.maxFramerate) >= 0)) {\n              throw new RangeError('max_framerate must be >= 0.0');\n            }\n          }\n        });\n      }\n      var transceiver = origAddTransceiver.apply(this, arguments);\n      if (shouldPerformCheck) {\n        // Check if the init options were applied. If not we do this in an\n        // asynchronous way and save the promise reference in a global object.\n        // This is an ugly hack, but at the same time is way more robust than\n        // checking the sender parameters before and after the createOffer\n        // Also note that after the createoffer we are not 100% sure that\n        // the params were asynchronously applied so we might miss the\n        // opportunity to recreate offer.\n        var sender = transceiver.sender;\n\n        var params = sender.getParameters();\n        if (!('encodings' in params) ||\n        // Avoid being fooled by patched getParameters() below.\n        params.encodings.length === 1 && Object.keys(params.encodings[0]).length === 0) {\n          params.encodings = initParameters.sendEncodings;\n          sender.sendEncodings = initParameters.sendEncodings;\n          this.setParametersPromises.push(sender.setParameters(params).then(function () {\n            delete sender.sendEncodings;\n          }).catch(function () {\n            delete sender.sendEncodings;\n          }));\n        }\n      }\n      return transceiver;\n    };\n  }\n}\n\nfunction shimGetParameters(window) {\n  if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCRtpSender)) {\n    return;\n  }\n  var origGetParameters = window.RTCRtpSender.prototype.getParameters;\n  if (origGetParameters) {\n    window.RTCRtpSender.prototype.getParameters = function getParameters() {\n      var params = origGetParameters.apply(this, arguments);\n      if (!('encodings' in params)) {\n        params.encodings = [].concat(this.sendEncodings || [{}]);\n      }\n      return params;\n    };\n  }\n}\n\nfunction shimCreateOffer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  var origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer = function createOffer() {\n    var _this4 = this,\n        _arguments2 = arguments;\n\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises).then(function () {\n        return origCreateOffer.apply(_this4, _arguments2);\n      }).finally(function () {\n        _this4.setParametersPromises = [];\n      });\n    }\n    return origCreateOffer.apply(this, arguments);\n  };\n}\n\nfunction shimCreateAnswer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  var origCreateAnswer = window.RTCPeerConnection.prototype.createAnswer;\n  window.RTCPeerConnection.prototype.createAnswer = function createAnswer() {\n    var _this5 = this,\n        _arguments3 = arguments;\n\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises).then(function () {\n        return origCreateAnswer.apply(_this5, _arguments3);\n      }).finally(function () {\n        _this5.setParametersPromises = [];\n      });\n    }\n    return origCreateAnswer.apply(this, arguments);\n  };\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}